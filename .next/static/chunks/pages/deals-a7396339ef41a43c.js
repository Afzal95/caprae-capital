(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[901],{1507:function(e,s,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/deals",function(){return a(6456)}])},1398:function(e,s,a){"use strict";a.d(s,{Z:function(){return c}});var t=a(5893),l=a(7294),i=a(1664),n=a.n(i),d=a(5007),r=a(1163);function c(e){let{children:s}=e,a=(0,d.v9)(e=>e.user.profileCompletion),i=(0,d.v9)(e=>e.user),c=!!i&&!!i.email||(null==i?void 0:i.isAuthenticated),o=(0,r.useRouter)();return l.useEffect(()=>{!c&&["/dashboard","/deals","/profile","/matches","/messages","/settings"].includes(o.pathname)&&o.replace("/")},[c,o.pathname]),(0,t.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[(0,t.jsx)("header",{className:"bg-white shadow mb-6",children:(0,t.jsx)("div",{className:"container mx-auto px-4 py-3 flex items-center",children:(0,t.jsx)("div",{className:"flex items-center gap-2 cursor-pointer",onClick:()=>o.push(c?"/role":"/"),children:(0,t.jsx)("span",{className:"font-bold text-xl text-teal-700",children:"Caprae"})})})}),(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsxs)("aside",{className:"w-64 bg-white border-r p-4",children:[(0,t.jsx)("div",{className:"font-bold text-teal text-lg mb-4",children:"Caprae Platform"}),(0,t.jsxs)("nav",{className:"space-y-2",children:[(0,t.jsx)(n(),{className:"block px-3 py-2 rounded hover:bg-mint/20",href:"/dashboard",children:"Dashboard"}),(0,t.jsx)(n(),{className:"block px-3 py-2 rounded hover:bg-mint/20",href:"/matches",children:"Matches"}),(0,t.jsx)(n(),{className:"block px-3 py-2 rounded hover:bg-mint/20",href:"/deals",children:"Deals"}),(0,t.jsx)(n(),{className:"block px-3 py-2 rounded hover:bg-mint/20",href:"/messages",children:"Messages"}),(0,t.jsx)(n(),{className:"block px-3 py-2 rounded hover:bg-mint/20",href:"/profile",children:"Profile"}),(0,t.jsx)(n(),{className:"block px-3 py-2 rounded hover:bg-mint/20",href:"/settings",children:"Settings"})]}),!c&&(0,t.jsxs)("div",{className:"mt-6 text-sm text-gray-500",children:[(0,t.jsx)("div",{className:"mb-2",children:"You are viewing as a guest. Some features may be limited."}),(0,t.jsx)(n(),{href:"/login",className:"text-teal-600 underline",children:"Login to access full features"})]}),c&&(0,t.jsxs)("div",{className:"mt-6 text-sm",children:[(0,t.jsx)("div",{className:"mb-1 font-medium",children:"Profile Completion"}),(0,t.jsx)("div",{className:"w-full bg-gray-100 rounded h-2",children:(0,t.jsx)("div",{className:"bg-teal h-2 rounded",style:{width:"".concat(a,"%")}})})]})]}),(0,t.jsx)("main",{className:"flex-1 p-6",children:s})]})]})}},4738:function(e,s,a){"use strict";a.d(s,{Z:function(){return d}});var t=a(5893),l=a(5007),i=a(5269),n=a(7294);function d(e){let{deal:s}=e,a=(0,l.I0)(),[d,r]=(0,n.useState)("");return(0,t.jsxs)("div",{className:"card",children:[(0,t.jsx)("div",{className:"font-semibold mb-2",children:"Messages"}),(0,t.jsx)("div",{className:"h-48 overflow-auto border rounded-xl2 p-2 bg-gray-50",children:s.messages.map(e=>(0,t.jsxs)("div",{className:"mb-2",children:[(0,t.jsxs)("div",{className:"text-xs text-gray-500",children:[e.from," • ",new Date(e.at).toLocaleString()]}),(0,t.jsx)("div",{children:e.text})]},e.id))}),(0,t.jsxs)("div",{className:"mt-2 flex gap-2",children:[(0,t.jsx)("input",{className:"flex-1 border rounded-xl2 p-2",value:d,onChange:e=>r(e.target.value),placeholder:"Type a message..."}),(0,t.jsx)("button",{className:"btn bg-teal text-white",onClick:()=>{d&&(a((0,i.bG)({dealId:s.id,from:"you",text:d})),r(""))},children:"Send"})]}),(0,t.jsxs)("div",{className:"mt-2 text-sm",children:["Quick templates:",(0,t.jsx)("div",{className:"flex gap-2 mt-1",children:["Please share updated LOI","Let’s schedule diligence call","Sharing NDA shortly"].map(e=>(0,t.jsx)("button",{className:"tag hover:bg-mint/50",onClick:()=>a((0,i.bG)({dealId:s.id,from:"you",text:e})),children:e},e))})]})]})}},6456:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return m}});var t=a(5893),l=a(1398),i=a(5007),n=a(7294),d=a(5269);function r(e){let{deal:s,role:a}=e,l=(0,i.I0)(),[r,c]=(0,n.useState)(""),[o,m]=(0,n.useState)(""),x=(e,t)=>{let i=e.target.files&&e.target.files[0];if(i&&(c(i.name),l((0,d.iG)({dealId:s.id,docType:t,name:i.name,uploadedBy:a})),"nda"===t)){let e="This NDA (uploaded as ".concat(i.name,") requires both parties to keep confidential information private for 3 years. It limits use of data to evaluation purposes and includes standard non-disclosure clauses.");m(e),l((0,d.dw)({dealId:s.id,summary:e}))}},h=e=>{l((0,d.QT)({dealId:s.id,role:e}))};return(0,t.jsxs)("div",{className:"card space-y-4",children:[(0,t.jsxs)("div",{className:"text-lg font-semibold",children:["Stage: ",s.stage]}),"NDA"===s.stage&&(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"mb-2",children:"Upload NDA (PDF or Image)"}),(0,t.jsx)("input",{type:"file",accept:"application/pdf,image/*",onChange:e=>x(e,"nda")}),r&&(0,t.jsxs)("div",{className:"mt-2 text-sm text-gray-700",children:["Uploaded: ",r]}),s.ndaSummary&&(0,t.jsxs)("div",{className:"mt-3 p-3 bg-gray-50 rounded",children:[(0,t.jsx)("div",{className:"font-medium",children:"AI Summary of NDA"}),(0,t.jsx)("div",{className:"text-sm text-gray-700 mt-1",children:s.ndaSummary})]}),(0,t.jsxs)("div",{className:"mt-3 flex gap-2",children:[!s.signed.seller&&"seller"===a&&(0,t.jsx)("button",{className:"btn bg-teal text-white",onClick:()=>h("seller"),children:"Sign NDA (Seller)"}),!s.signed.buyer&&"buyer"===a&&(0,t.jsx)("button",{className:"btn bg-teal text-white",onClick:()=>h("buyer"),children:"Sign NDA (Buyer)"})]})]}),"Due Diligence"===s.stage&&(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"mb-2",children:"Upload Financials / Documents"}),(0,t.jsx)("input",{type:"file",accept:"application/pdf,image/*",onChange:e=>x(e,"financials")}),(0,t.jsxs)("div",{className:"mt-3",children:[(0,t.jsx)("div",{className:"font-medium",children:"AI Risk Highlights (stub)"}),(0,t.jsxs)("ul",{className:"list-disc pl-6 text-sm text-gray-700 mt-2",children:[(0,t.jsx)("li",{children:"Revenue concentration: top 3 customers = 45% of revenue."}),(0,t.jsx)("li",{children:"Key person risk: CEO responsible for major client relationships."}),(0,t.jsx)("li",{children:"Minor compliance item in 2019 (disclosed)."})]})]})]}),"Negotiation"===s.stage&&(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"mb-2",children:"Offers"}),(0,t.jsxs)("div",{className:"space-y-2",children:[0===s.offers.length&&(0,t.jsx)("div",{className:"text-sm text-gray-500",children:"No offers yet."}),s.offers.map(e=>(0,t.jsxs)("div",{className:"p-3 bg-gray-50 rounded flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"font-medium",children:[e.from," • $",e.amount]}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:new Date(e.at).toLocaleString()})]}),(0,t.jsx)("div",{className:"flex gap-2",children:a!==e.from&&"pending"===e.status&&(0,t.jsx)("button",{className:"btn bg-white border",onClick:()=>{let a=confirm("Accept offer?");l((0,d.N$)({dealId:s.id,offerId:e.id,status:a?"accepted":"rejected"}))},children:"Respond"})})]},e.id))]}),(0,t.jsx)("div",{className:"mt-3",children:(0,t.jsx)("button",{className:"btn bg-teal text-white",onClick:()=>{let e=prompt("Enter offer amount (e.g., 1200000)");e&&l((0,d.ZH)({dealId:s.id,amount:e,from:a,notes:""}))},children:"Make an Offer"})})]}),"LOI"===s.stage&&(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium",children:"Draft LOI (auto-generated)"}),(0,t.jsxs)("div",{className:"mt-2 text-sm text-gray-700 bg-gray-50 p-3 rounded",children:["This Letter of Intent outlines the principal terms for the acquisition of ",s.counterpartName,". Purchase price, timeline, and exclusivity are included. (Stub)"]}),(0,t.jsx)("div",{className:"mt-3 flex gap-2",children:(0,t.jsx)("button",{className:"btn bg-teal text-white",onClick:()=>alert("LOI signed (stub)"),children:"Sign LOI"})})]}),"Contract"===s.stage&&(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"mb-2",children:"Upload final contract"}),(0,t.jsx)("input",{type:"file",accept:"application/pdf",onChange:e=>x(e,"contract")}),(0,t.jsx)("div",{className:"mt-3 text-sm text-gray-700",children:"After both parties confirm, mark as ready for closing."})]}),"Closing"===s.stage&&(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium",children:"Closing"}),(0,t.jsx)("div",{className:"mt-2 text-sm text-gray-700",children:"Confirm payment and transfer ownership documents."}),(0,t.jsx)("div",{className:"mt-3",children:(0,t.jsx)("button",{className:"btn bg-teal text-white",onClick:()=>alert("Payment confirmed (stub)"),children:"Confirm Payment"})})]})]})}function c(e){let{deal:s}=e;return(0,i.I0)(),(0,t.jsxs)("div",{className:"card",children:[(0,t.jsx)("div",{className:"text-lg font-semibold mb-2",children:"Pipeline"}),(0,t.jsx)("div",{className:"flex flex-col gap-3",children:d.Jf.map(e=>(0,t.jsx)("div",{className:"p-3 rounded ".concat(e===s.stage?"bg-teal text-white":"bg-gray-50"),children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("div",{className:"font-medium",children:e}),(0,t.jsx)("div",{className:"text-sm",children:e===s.stage?"Current":""})]})},e))})]})}var o=a(4738);function m(){let e=(0,i.I0)(),s=(0,i.v9)(e=>e.deals.deals),a=(0,i.v9)(e=>e.deals.activeDealId),m=(0,i.v9)(e=>e.user),[x]=(0,n.useState)(m.role||"buyer"),[h,g]=(0,n.useState)(!1),u=(0,n.useRef)(!1);(0,n.useEffect)(()=>{try{let s=localStorage.getItem("caprae_deals_v1");if(s){let a=JSON.parse(s);a&&Array.isArray(a.deals)&&a.deals.length>0?e((0,d.jw)(a)):e((0,d.jw)({deals:[{id:"sample1",counterpartName:"Acme Corp",stage:"NDA",tasks:[],messages:[],documents:[],ndaSummary:null,signed:{buyer:!0,seller:!0},offers:[],closed:!1}],activeDealId:"sample1"}))}else e((0,d.jw)({deals:[{id:"sample1",counterpartName:"Acme Corp",stage:"NDA",tasks:[],messages:[],documents:[],ndaSummary:null,signed:{buyer:!0,seller:!0},offers:[],closed:!1}],activeDealId:"sample1"}))}catch(e){}},[e]),(0,n.useEffect)(()=>{try{localStorage.setItem("caprae_deals_v1",JSON.stringify({deals:s,activeDealId:a}))}catch(e){}},[s,a]),(0,n.useEffect)(()=>{g(!1)},[]);let f=s.find(e=>e.id===a);if((0,n.useEffect)(()=>{f&&(!u.current&&f.closed&&g(!0),u.current=f.closed)},[null==f?void 0:f.closed]),!a)return(0,t.jsx)(l.Z,{children:(0,t.jsxs)("div",{className:"card",children:[(0,t.jsx)("div",{className:"text-lg font-semibold",children:"No active deal"}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Accept a match from the Matches page to start a deal."})]})});if(!f)return(0,t.jsx)(l.Z,{children:(0,t.jsx)("div",{className:"card",children:"Deal not found."})});let b=()=>{if(f){if("NDA"===f.stage&&(!f.signed.buyer||!f.signed.seller)){if(!window.confirm("Both parties must sign NDA before advancing. Click OK to sign for both and continue."))return;e((0,d.y1)(f.id))}e((0,d.Q2)(f.id))}};return(0,t.jsxs)(l.Z,{children:[h&&(0,t.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-40 z-50",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md text-center",children:[(0,t.jsx)("div",{className:"text-2xl font-bold mb-2",children:"\uD83C\uDF89 Congratulations!"}),(0,t.jsxs)("div",{className:"mb-4",children:["The deal with ",(0,t.jsx)("span",{className:"font-semibold",children:f.counterpartName})," has been ",(0,t.jsx)("span",{className:"text-green-600 font-semibold",children:"finalized and closed"}),"."]}),(0,t.jsx)("div",{className:"mb-4 text-sm text-gray-600",children:"Thank you for using Caprae Platform. You can view details or start a new deal from the dashboard."}),(0,t.jsx)("button",{className:"btn bg-teal text-white mt-2",onClick:()=>g(!1),children:"Close"})]})}),(0,t.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"text-xl font-semibold",children:["Deal with ",f.counterpartName]}),(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:["Stage: ",f.stage]}),(0,t.jsxs)("div",{className:"text-sm text-gray-700 mt-1",children:["Status: ",f.closed?"Closed":"NDA"===f.stage?"Opened":"In Progress"]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{className:"btn bg-white border",onClick:()=>e((0,d.mN)(null)),children:"Exit Deal"}),(0,t.jsx)("button",{className:"btn bg-red-500 text-white",onClick:()=>{localStorage.clear(),window.location.href="/"},children:"Logout"}),(0,t.jsx)("button",{className:"btn bg-gray-400 text-white",onClick:()=>{e({type:"deals/rejectDeal",payload:f.id}),e((0,d.mN)(null))},children:"Reject Deal"})]})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"md:col-span-2 space-y-4",children:[(0,t.jsx)(r,{deal:f,role:x}),"NDA"===f.stage&&(0,t.jsxs)("div",{className:"card mb-4",children:[(0,t.jsx)("div",{className:"font-medium mb-2",children:"Sign NDA"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{className:"btn ".concat(f.signed.seller?"bg-gray-300 text-gray-500":"bg-blue-500 text-white"),disabled:f.signed.seller,onClick:()=>e({type:"deals/signDocument",payload:{dealId:f.id,role:"seller"}}),children:f.signed.seller?"Seller Signed":"Sign as Seller"}),(0,t.jsx)("button",{className:"btn ".concat(f.signed.buyer?"bg-gray-300 text-gray-500":"bg-green-500 text-white"),disabled:f.signed.buyer,onClick:()=>e({type:"deals/signDocument",payload:{dealId:f.id,role:"buyer"}}),children:f.signed.buyer?"Buyer Signed":"Sign as Buyer"})]}),(0,t.jsxs)("div",{className:"flex gap-2 flex-col mt-4",children:[(0,t.jsx)("button",{className:"btn ".concat(f.signed.buyer||f.signed.seller?"bg-teal text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"),onClick:b,disabled:!(f.signed.buyer||f.signed.seller),children:"Advance Stage"}),!(f.signed.buyer||f.signed.seller)&&(0,t.jsx)("div",{className:"text-xs text-red-500 mt-1",children:"At least one party must sign NDA before advancing."})]})]}),"NDA"!==f.stage&&"Closing"!==f.stage&&(0,t.jsx)("div",{className:"card mb-4",children:(0,t.jsx)("div",{className:"flex gap-2 flex-col",children:(0,t.jsx)("button",{className:"btn bg-teal text-white",onClick:b,children:"Advance Stage"})})}),"Closing"===f.stage&&(0,t.jsx)("div",{className:"card mb-4",children:(0,t.jsxs)("div",{className:"flex gap-2 flex-col",children:[(0,t.jsx)("button",{className:"btn bg-green-600 text-white",onClick:()=>{window.confirm("Confirm payment received and close the deal?")&&(e({type:"deals/markClosed",payload:f.id}),g(!0))},children:"Close Deal"}),(0,t.jsx)("div",{className:"text-xs text-gray-600 mt-1",children:"Once payment is confirmed, click to finalize and close the deal."})]})}),"Due Diligence"===f.stage&&(0,t.jsxs)("div",{className:"card mb-4",children:[(0,t.jsx)("div",{className:"font-medium mb-2",children:"AI Risk Highlights"}),f.documents&&f.documents.length>0?(0,t.jsx)("div",{className:"text-sm text-gray-700",children:"AI Risk Highlights (stub): Financials/Documents have been uploaded. [AI analysis would appear here]"}):(0,t.jsx)("div",{className:"text-sm text-red-500",children:"Please upload Financials or Documents to view AI Risk Highlights."})]}),(0,t.jsxs)("div",{className:"card",children:[(0,t.jsx)("div",{className:"font-medium mb-2",children:"Offer History"}),0===f.offers.length?(0,t.jsx)("div",{className:"text-sm text-gray-500",children:"No offers yet"}):f.offers.map(e=>(0,t.jsxs)("div",{className:"p-2 bg-gray-50 rounded mb-2",children:[(0,t.jsxs)("div",{className:"text-sm font-medium",children:[e.from," • $",e.amount," • ",(0,t.jsx)("span",{className:"text-xs text-gray-500",children:e.status})]}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:new Date(e.at).toLocaleString()})]},e.id))]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(c,{deal:f}),(0,t.jsx)(o.Z,{deal:f})]})]})]})}}},function(e){e.O(0,[424,888,774,179],function(){return e(e.s=1507)}),_N_E=e.O()}]);